{% extends "base.html" %}
{% block title %}Nouvelle évaluation — Maturité ComNum{% endblock %}

{% block content %}
<h1 class="fr-h3 fr-mb-4w">Lancer une évaluation</h1>

<div class="fr-card" style="max-width: 600px;">
    <div class="fr-card__body">
        <div class="fr-card__content">
            {% if not campagnes %}
            <div class="fr-alert fr-alert--warning fr-alert--sm">
                <p>Aucune campagne en cours. <a href="{{ url_for('campagne_new') }}">Créez d'abord une campagne.</a></p>
            </div>
            {% elif not entites %}
            <div class="fr-alert fr-alert--warning fr-alert--sm">
                <p>Aucune entité enregistrée. <a href="{{ url_for('entite_new') }}">Créez d'abord une entité.</a></p>
            </div>
            {% else %}
            <form method="POST">
                <div class="fr-select-group">
                    <label class="fr-label" for="campagne_id">Campagne</label>
                    <select class="fr-select" id="campagne_id" name="campagne_id" required>
                        {% for c in campagnes %}
                        <option value="{{ c.id }}">{{ c.label }} ({{ c.date_debut.strftime('%d/%m/%Y') }})</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="fr-select-group">
                    <label class="fr-label" for="entite_id">Entité à évaluer</label>
                    <select class="fr-select" id="entite_id" name="entite_id" required>
                        {% for e in entites %}
                        <option value="{{ e.id }}">{{ e.nom }} ({{ e.type }})</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="fr-input-group">
                    <label class="fr-label" for="evaluateur">Évaluateur (optionnel)</label>
                    <input class="fr-input" type="text" id="evaluateur" name="evaluateur"
                           placeholder="Nom de la personne qui évalue">
                </div>
                <ul class="fr-btns-group fr-btns-group--inline">
                    <li><button type="submit" class="fr-btn fr-btn--icon-left fr-icon-clipboard-line">Démarrer l'évaluation</button></li>
                    <li><a href="{{ url_for('evaluations_list') }}" class="fr-btn fr-btn--secondary">Annuler</a></li>
                </ul>
            </form>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}
